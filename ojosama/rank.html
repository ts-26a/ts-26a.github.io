<!doctype html>
<html lang="ja">
    <head>
        <link rel="icon" href="../ico/favicon.ico">
        <link rel="stylesheet" href="../css/main.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c&family=Ubuntu+Mono&display=swap">
        <script>
            async function onClick() {
                const baseUrl = "https://script.google.com/macros/s/AKfycbxUFzmeyOaerPo4MA2NOA1kzx8fKaJFsuVV6ji9nwDQyhV9A-iY/exec";
                const _screen_name = document.forms.sc_n.screen_name.value;
                if (_screen_name.match(/@?[a-zA-Z0-9_]+/) === null
                        || _screen_name.includes(" ")) {
                    alert("Invalid id");
                    return;
                }
                const screen_name = _screen_name.replace("@", "");
                const url = baseUrl + "?input=" + screen_name;
                const _res = await fetch(url);
                const res = await _res.json();
                const div = document.getElementById("div_id");
                div.removeAttribute("hidden");
                const rank = document.getElementById("rank_id");
                const rate = document.getElementById("rate_id");
                rank.innerHTML = res["rank"];
                rate.innerHTML = res["rate"];
            }
        </script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Tea Time Rank</title>
    </head>
    <body>
        <form id="sc_n">
            <label>Your account id: <input type="text" method="post" name="screen_name" /></label>
            <input type="button" value="submit" onclick="onClick();" />
        </form>
        <div id="div_id" hidden>
            <br/>
            <label>Your rank: <span id="rank_id"></span></label>
            <br/>
            <label>Your rate: <span id="rate_id"></span></label>
        </div>
        <br>
        <br>
        <a href="../index.html">Home</a>
    </body>
</html>
